
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Usercentrics LCP Workaround Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body { margin:0; font-family:Arial, sans-serif; background:#111; color:#fff; }
  .hero {
    width:100%;
    height:60px; /* small so CMP becomes LCP */
    background:#333;
  }
  .content {
    padding:20px;
    font-size:18px;
  }
</style>

<!-- Usercentrics CMP -->
<script src="https://web.cmp.usercentrics.eu/tcf/stub.js"></script>
<script id="usercentrics-cmp"
        src="https://web.cmp.usercentrics.eu/ui/loader.js"
        data-settings-id="EB4fNiNKxOwpYl"
        async></script>

<!-- Workaround: split privacy text into paragraphs -->
<script>
(function() {
  console.log("[UC-LCP-FIX] Workaround script loaded");

  function tryApplyFix() {
    const host = document.querySelector("aside#usercentrics-cmp-ui");
    if (!host || !host.shadowRoot) {
      console.log("[UC-LCP-FIX] shadowRoot not ready yet");
      return;
    }

    const shadow = host.shadowRoot;
    const target = shadow.querySelector("#uc-privacy-description .privacy-text-detailed");

    if (!target) {
      console.log("[UC-LCP-FIX] privacy-text-detailed not found yet");
      return;
    }

    console.log("[UC-LCP-FIX] Element found — applying workaround");

    target.textContent = "This is the modified text used for LCP testing.";

    // Observe future updates from Usercentrics
    new MutationObserver(() => {
      const t = shadow.querySelector("#uc-privacy-description .privacy-text-detailed");
      if (t && t.textContent !== "This is the modified text used for LCP testing.") {
        console.log("[UC-LCP-FIX] Detected Usercentrics update → Reapplying text");
        t.textContent = "This is the modified text used for LCP testing.";
      }
    }).observe(shadow, { childList: true, subtree: true });

  }

  // Try frequently until UC finishes loading
  const interval = setInterval(() => {
    tryApplyFix();
  }, 200);

  // Stop trying once it works
  const stopWhenReady = setInterval(() => {
    const host = document.querySelector("aside#usercentrics-cmp-ui");
    if (host && host.shadowRoot && host.shadowRoot.querySelector("#uc-privacy-description .privacy-text-detailed")) {
      clearInterval(interval);
      clearInterval(stopWhenReady);
      console.log("[UC-LCP-FIX] Workaround fully activated");
    }
  }, 500);

})();
</script>



</head>
<body>

<div class="hero"></div>

<div class="content">
  <h1>CMP LCP Workaround Test Page</h1>
  <p>This page forces the CMP to become the initial LCP and applies the paragraph workaround for testing.</p>
</div>

</body>
</html>
