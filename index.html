
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Usercentrics LCP Workaround Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body { margin:0; font-family:Arial, sans-serif; background:#111; color:#fff; }
  .hero {
    width:100%;
    height:60px; /* small so CMP becomes LCP */
    background:#333;
  }
  .content {
    padding:20px;
    font-size:18px;
  }
</style>

<!-- Usercentrics CMP -->
<script src="https://web.cmp.usercentrics.eu/tcf/stub.js"></script>
<script id="usercentrics-cmp"
        src="https://web.cmp.usercentrics.eu/ui/loader.js"
        data-settings-id="EB4fNiNKxOwpYl"
        async></script>

<!-- Workaround: split privacy text into paragraphs -->
<script>
(function() {
  function applyWorkaround() {
    const host = document.querySelector('#usercentrics-cmp-ui');
    if (!host || !host.shadowRoot) return;

    const root = host.shadowRoot;

    // This is the REAL location of the legal text
    const span = root.querySelector('#uc-privacy-description .privacy-text-detailed');
    if (!span) return;

    const original = span.textContent.trim();
    if (!original || original.length < 50) return; // already processed or too small

    const sentences = original.split(/(?<=[.!?])\s+/);

    span.innerHTML = sentences
      .map(s => `<p style="margin:0 0 10px 0; line-height:1.3;">${s}</p>`)
      .join('');
  }

  // Watch for CMP rendering
  const observer = new MutationObserver(() => applyWorkaround());
  observer.observe(document.documentElement, { childList: true, subtree: true });

  document.addEventListener("DOMContentLoaded", applyWorkaround);
})();
</script>

</head>
<body>

<div class="hero"></div>

<div class="content">
  <h1>CMP LCP Workaround Test Page</h1>
  <p>This page forces the CMP to become the initial LCP and applies the paragraph workaround for testing.</p>
</div>

</body>
</html>
